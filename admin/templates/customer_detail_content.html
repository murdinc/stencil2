{{define "content"}}
<div class="content-header">
    <h2>{{.Customer.FirstName}} {{.Customer.LastName}}</h2>
    <p>Customer details</p>
</div>

<div style="display: grid; grid-template-columns: 1fr 2fr; gap: 20px; margin-bottom: 20px;">
    <!-- Customer Info Column -->
    <div>
        <div class="card" style="margin-bottom: 20px;">
            <h3>Customer Information</h3>
            <div style="margin-bottom: 12px;">
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555; font-size: 12px;">Email</label>
                <p style="margin: 0;">{{.Customer.Email}}</p>
            </div>
            <div style="margin-bottom: 12px;">
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555; font-size: 12px;">Name</label>
                <p style="margin: 0;">{{.Customer.FirstName}} {{.Customer.LastName}}</p>
            </div>
            {{if .Customer.Phone}}
            <div style="margin-bottom: 12px;">
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555; font-size: 12px;">Phone</label>
                <p style="margin: 0;">{{.Customer.Phone}}</p>
            </div>
            {{end}}
            {{if .Customer.StripeCustomerID}}
            <div style="margin-bottom: 12px;">
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555; font-size: 12px;">Stripe Customer ID</label>
                <p style="margin: 0; font-family: monospace; font-size: 12px;">{{.Customer.StripeCustomerID}}</p>
            </div>
            {{end}}
            <div>
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555; font-size: 12px;">Joined</label>
                <p style="margin: 0;">{{.Customer.CreatedAt.Format "January 2, 2006"}}</p>
            </div>
        </div>

        <div class="card">
            <h3>Statistics</h3>
            <div style="margin-bottom: 12px;">
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555; font-size: 12px;">Total Orders</label>
                <p style="margin: 0; font-size: 24px; font-weight: 600; color: #667eea;">{{.Customer.OrderCount}}</p>
            </div>
            <div style="margin-bottom: 12px;">
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555; font-size: 12px;">Total Spent</label>
                <p style="margin: 0; font-size: 24px; font-weight: 600; color: #48bb78;">${{printf "%.2f" .Customer.TotalSpent}}</p>
            </div>
            <div style="margin-bottom: 12px;">
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555; font-size: 12px;">Average Order Value</label>
                <p style="margin: 0; font-size: 18px; font-weight: 600;">${{printf "%.2f" .AvgOrderValue}}</p>
            </div>
            {{if .Customer.FirstOrder}}
            <div style="margin-bottom: 12px;">
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555; font-size: 12px;">First Order</label>
                <p style="margin: 0;">{{.Customer.FirstOrder.Format "Jan 2, 2006"}}</p>
            </div>
            {{end}}
            {{if .Customer.LastOrder}}
            <div>
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555; font-size: 12px;">Last Order</label>
                <p style="margin: 0;">{{.Customer.LastOrder.Format "Jan 2, 2006"}}</p>
            </div>
            {{end}}
        </div>
    </div>

    <!-- Order History Column -->
    <div class="card">
        <h3>Order History</h3>
        {{if .Orders}}
        <table>
            <thead>
                <tr>
                    <th>Order #</th>
                    <th>Total</th>
                    <th>Payment</th>
                    <th>Fulfillment</th>
                    <th>Date</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {{range .Orders}}
                <tr>
                    <td><strong>{{.OrderNumber}}</strong></td>
                    <td>${{printf "%.2f" .Total}}</td>
                    <td>
                        {{if eq .PaymentStatus "pending"}}
                            <span style="color: #f59e0b;">Pending</span>
                        {{else if eq .PaymentStatus "paid"}}
                            <span style="color: #48bb78;">Paid</span>
                        {{else}}
                            <span style="color: #f56565;">{{.PaymentStatus}}</span>
                        {{end}}
                    </td>
                    <td>
                        {{if eq .FulfillmentStatus "unfulfilled"}}
                            <span style="color: #f59e0b;">Unfulfilled</span>
                        {{else if eq .FulfillmentStatus "fulfilled"}}
                            <span style="color: #48bb78;">Fulfilled</span>
                        {{else}}
                            <span>{{.FulfillmentStatus}}</span>
                        {{end}}
                    </td>
                    <td>{{.CreatedAt.Format "Jan 2, 2006"}}</td>
                    <td class="actions">
                        <a href="/site/{{$.Website.ID}}/orders/{{.ID}}" class="btn btn-sm">View</a>
                    </td>
                </tr>
                {{end}}
            </tbody>
        </table>
        {{else}}
        <div class="empty-state">
            <p>No orders yet</p>
        </div>
        {{end}}
    </div>
</div>

<a href="/site/{{.Website.ID}}/customers" class="btn">‚Üê Back to Customers</a>
{{end}}
