{{define "content"}}
<div class="content-header">
    <h2>Order {{.Order.OrderNumber}}</h2>
    <p>View order details for {{.Website.SiteName}}</p>
</div>

<div style="display: grid; grid-template-columns: 2fr 1fr; gap: 20px; margin-bottom: 20px;">
    <!-- Order Items -->
    <div class="card">
        <h3>Order Items</h3>
        <table>
            <thead>
                <tr>
                    <th>Product</th>
                    <th>Variant</th>
                    <th>Price</th>
                    <th>Quantity</th>
                    <th>Total</th>
                </tr>
            </thead>
            <tbody>
                {{range .Order.Items}}
                <tr>
                    <td><strong>{{.ProductName}}</strong></td>
                    <td>{{if .VariantTitle}}{{.VariantTitle}}{{else}}-{{end}}</td>
                    <td>${{printf "%.2f" .Price}}</td>
                    <td>{{.Quantity}}</td>
                    <td>${{printf "%.2f" .Total}}</td>
                </tr>
                {{end}}
            </tbody>
        </table>

        <div style="margin-top: 20px; padding-top: 20px; border-top: 2px solid #e1e8ed;">
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span>Subtotal:</span>
                <span>${{printf "%.2f" .Order.Subtotal}}</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span>Tax:</span>
                <span>${{printf "%.2f" .Order.Tax}}</span>
            </div>
            <div style="display: flex; justify-content: space-between; margin-bottom: 10px;">
                <span>Shipping:</span>
                <span>${{printf "%.2f" .Order.ShippingCost}}</span>
            </div>
            <div style="display: flex; justify-content: space-between; font-size: 18px; font-weight: 600; padding-top: 10px; border-top: 2px solid #667eea;">
                <span>Total:</span>
                <span>${{printf "%.2f" .Order.Total}}</span>
            </div>
        </div>
    </div>

    <!-- Order Info -->
    <div>
        <div class="card" style="margin-bottom: 20px;">
            <h3>Order Status</h3>
            <div style="margin-bottom: 16px;">
                <label style="display: block; font-weight: 600; margin-bottom: 4px; color: #555;">Payment Status</label>
                <div style="padding: 8px 12px; border-radius: 4px; display: inline-block;
                    {{if eq .Order.PaymentStatus "paid"}}background: #e6ffed; color: #48bb78; border: 1px solid #48bb78;
                    {{else if eq .Order.PaymentStatus "pending"}}background: #fff4e6; color: #f59e0b; border: 1px solid #f59e0b;
                    {{else}}background: #fee; color: #f56565; border: 1px solid #f56565;{{end}}">
                    {{.Order.PaymentStatus}}
                </div>
            </div>
            <div>
                <label style="display: block; font-weight: 600; margin-bottom: 8px; color: #555;">Fulfillment Status</label>
                {{if eq .Order.PaymentStatus "paid"}}
                <form action="/site/{{.Website.ID}}/orders/{{.Order.ID}}/fulfillment" method="POST" style="display: flex; gap: 8px; align-items: center;">
                    <select name="fulfillment_status" style="padding: 8px 12px; border: 1px solid #ddd; border-radius: 4px; font-size: 14px;">
                        <option value="unfulfilled" {{if eq .Order.FulfillmentStatus "unfulfilled"}}selected{{end}}>Unfulfilled</option>
                        <option value="processing" {{if eq .Order.FulfillmentStatus "processing"}}selected{{end}}>Processing</option>
                        <option value="fulfilled" {{if eq .Order.FulfillmentStatus "fulfilled"}}selected{{end}}>Fulfilled</option>
                        <option value="shipped" {{if eq .Order.FulfillmentStatus "shipped"}}selected{{end}}>Shipped</option>
                    </select>
                    <button type="submit" class="btn btn-sm">Update</button>
                </form>
                {{else}}
                <div style="padding: 8px 12px; border-radius: 4px; display: inline-block;
                    {{if eq .Order.FulfillmentStatus "fulfilled"}}background: #e6ffed; color: #48bb78; border: 1px solid #48bb78;
                    {{else if eq .Order.FulfillmentStatus "unfulfilled"}}background: #fff4e6; color: #f59e0b; border: 1px solid #f59e0b;
                    {{else}}background: #e8eef5; color: #4a5568; border: 1px solid #d1d5db;{{end}}">
                    {{.Order.FulfillmentStatus}}
                </div>
                <p style="font-size: 12px; color: #999; margin-top: 8px;">Payment must be completed before fulfillment can be updated</p>
                {{end}}
            </div>
        </div>

        <div class="card" style="margin-bottom: 20px;">
            <h3>Customer</h3>
            <p><strong>{{.Order.CustomerName}}</strong></p>
            <p>{{.Order.CustomerEmail}}</p>
        </div>

        <div class="card">
            <h3>Shipping Address</h3>
            <p>{{.Order.ShippingAddressLine1}}</p>
            {{if .Order.ShippingAddressLine2}}
            <p>{{.Order.ShippingAddressLine2}}</p>
            {{end}}
            <p>{{.Order.ShippingCity}}, {{.Order.ShippingState}} {{.Order.ShippingZip}}</p>
            <p>{{.Order.ShippingCountry}}</p>
        </div>
    </div>
</div>

<a href="/site/{{.Website.ID}}/orders" class="btn">‚Üê Back to Orders</a>
{{end}}
